import pandas as pd  # データ分析用ライブラリ

import utils  # 自作のユーティリティモジュール（ログ出力やエラーハンドリング用）


def main():
    """
    テスト用のExcelファイル (A.xlsx) を作成するスクリプトです。
    """
    # 関数の開始をログ出力（処理の流れを追うため）
    utils.log_start("main")

    # --- サンプルデータの作成 ---
    # Pythonの辞書（dictionary）形式でデータを定義します。
    # キー（'ID'など）が列名になり、リスト（[]の中身）が各行のデータになります。
    # 初心者向け解説: 辞書は {キー: 値} のペアでデータを管理する仕組みです。
    data = {
        "ID": [1, 2, 3, 4, 5],
        "Task Name": [
            "要件定義",
            "基本設計",
            "詳細設計",
            "実装",
            "テスト",
        ],  # B列想定
        "Assignee": ["田中", "佐藤", "鈴木", "高橋", "伊藤"],
        "Start Date": [
            "2025-01-01",
            "2025-01-10",
            "2025-01-20",
            "2025-02-01",
            "2025-02-15",
        ],
        "End Date": [
            "2025-01-09",
            "2025-01-19",
            "2025-01-31",
            "2025-02-14",
            "2025-02-28",
        ],
        "Status": ["完了", "完了", "対応中", "未着手", "未着手"],  # F列想定
    }
    print("データ定義完了: ", data)  # デバッグ用にデータの中身を表示

    # --- データフレームへの変換 ---
    # 辞書データを pandas の DataFrame 形式に変換します。
    # これにより、Excelのように行と列でデータを扱えるようになります。
    df = pd.DataFrame(data)
    print("データフレーム変換完了")

    # --- Excelファイルへの保存 ---
    output_file = "A.xlsx"

    try:
        # index=False は、一番左に行番号（0, 1, 2...）を出力しないための設定です。
        # 初心者向け解説: to_excel メソッドを使うと、DataFrameを簡単にExcelファイルとして保存できます。
        # ここは外部ファイルへの書き込み（I/O）なので、エラーが発生する可能性があります（例：ファイルが開かれているなど）。
        # そのため、try-exceptブロックで囲んでエラーハンドリングを行います。
        df.to_excel(output_file, index=False)
        print(f"成功: サンプルデータ '{output_file}' を作成しました。")
        print("中身を確認するには、Excelでファイルを開いてください。")

    except Exception as e:
        # エラーが発生した場合、自作の utils.handle_error 関数を呼び出して
        # 詳細なエラー情報（スタックトレース、変数の値、原因分析）を表示します。
        utils.handle_error(e)

    # 処理終了のログ出力
    utils.log_end("main")


if __name__ == "__main__":
    main()
